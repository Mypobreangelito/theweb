---
import Base from "../../layouts/Base.astro";
import { getCollection } from "astro:content";

// solo publicados y ordenados por fecha
const posts = (await getCollection("escritos", (p) => !p.data.draft))
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());

const base = import.meta.env.BASE_URL.endsWith("/")
  ? import.meta.env.BASE_URL
  : import.meta.env.BASE_URL + "/";
---

<Base title="Escritos" description="Journal científico y poético.">
  <main class="mx-auto max-w-3xl px-4 py-8 space-y-6">
    <h1 class="text-3xl font-bold tracking-tight">Escritos</h1>

    <ul class="space-y-4">
      {posts.map(({ slug, data }) => (
        <li class="border-b pb-4">
          <a
            class="text-lg font-semibold hover:underline"
            href={`${base}escritos/${slug}/`}
          >
            {data.title}
          </a>
          {data.description && <p class="text-gray-600">{data.description}</p>}
          <p class="text-sm text-gray-500">
            {new Date(data.date).toLocaleDateString()}
          </p>
        </li>
      ))}
    </ul>
  </main>
</Base>